{% extends 'base.html.twig' %}

{% block body %}
    {% if app.user  %}
        {% if  app.user.id == app.request.get("id") %} 
        {#{% if is_granted('IS_AUTHENTICATED_FULLY') %} #}
            <a href="{{ path('profile_show',{'id':app.user.id})}}" class="btn-btn-primary">
                Retour
            </a>
            <h2> Modification des données personnelles </h2>
            <form action="{{path('profile_edit',{'id':app.user.id}) }}" method="post">

                    {{ form_start(formUser) }}

                {# <div class="form-group">
                <label for="">Nom</label>
                {{ form_row(formUser.name) }}
            </div>

            <div class="form-group">
                <label for="">Prénom</label>
                {{ form_row(formUser.firstname) }}
            </div>

            <div class="form-group">
                <label for="">Date de naissance</label>
                {{ form_row(formUser.birthday) }}
            </div>

            <div class="form-group">
                <label for="">Genre</label>
                {{ form_row(formUser.sex) }}
            </div>
#}
                    <button type="submit" class="btn btn-link">Enregister modification(s)</button>
                    {{ form_end(formUser) }}

                <div class="col-4">
                    <button type="submit" class="btn btn-link">Modifier mot de passe</button>
                </div>
            </div>

            </form>



            <h3> <br>Téléphones</h3>

            {% for phone in user.phones %}
                <form action="{{path('remove_phone',{'idPhone':phone.id, 'idUser':user.id}) }}" method="post">
                <div class="phone">
                    <div class="row">
                        <div class="col-2">
                            {{ phone.type }}
                        </div>
                        <div class="col">
                             {{ phone.num}}
                        </div>
                        <div class="col">
                            <button type="submit" class="btn btn-link">Supprimer numéro</button>
                        </div>
                    </div>
                </div>
                </form>
            {% endfor %}


            <h4> <br>Nouveau numéro</h4>
{#
            <select name="Type">
                <option value="Domicile">Domicile</option>
                <option value="Portable">Portable</option>
                <option value="Travaille">Travail</option>
            </select>
#}  <form action="{{path('profile_edit',{'id':user.id}) }}" method="post">
            <div class = "phone">
                <div class="row">
                    <div class="col-2">
                         Type
                        {{ form_widget(phoneForm.type,  {'attr':{
                            'placeholder':"Domicile, travail..."
                        }}) }}
                    </div>
                    <div class="col">
                        Numéro
                        {{ form_widget(phoneForm.num,  {'attr':{
                            'placeholder':"Votre nouveau numéro..."
                        }}) }}
                    </div>
                    <div class="col">
                            <button type="submit" class="btn btn-link"><br>Ajouter numéro</button>
                    </div>
                </div>
            </div>
    </form>

            {#Affiche adresses#}
            <h3> <br>Adresses</h3>

            {% for adress in user.adress %}
                <form action="{{path('remove_adress',{'idAdress':adress.id, 'idUser':user.id}) }}" method="post">
                <div class="adress">
                    <div class="row">
                        <div class="col-2">
                             {{ adress.type }}
                        </div>
                        <div class="col">
                            {{ adress.num }} (BP:{{ adress.postBox }})
                        </div>
                        <div class="col">
                            {{ adress.streetName}}
                        </div>
                        <div class="col">
                             {{ adress.city.cityName}}
                            ({{ adress.city.zip}})
                        </div>
                        <div class="col">
                             {{ adress.city.country.countryName}}
                        </div>
                        <div class="col">
                            <button type="submit" class="btn btn-link">Supprimer adresse</button>
                        </div>
                    </div>
                </div>
                </form>
            {% endfor %}

            <h4> <br>Nouvelle adresse</h4>
            <form action="{{path('profile_edit',{'id':user.id}) }}" method="post">
                <div class="row">
                    <div class="col-2">
                        Type {{ form_widget(adressForm.type) }}
                    </div>
                    <div class="col-2">
                        Numero {{ form_widget(adressForm.num) }}
                    </div>
                    <div class="col-2">
                        BP {{ form_widget(adressForm.postBox) }}
                    </div>
                    <div class="col-11">
                        Rue  {{ form_widget(adressForm.streetName) }}
                    </div>
                    <div class="col-2">
                        CP {{ (form_widget(cityForm.zip) ) }}
                    </div>
                    <div class="col-4">
                        Ville  {{ form_widget(cityForm.cityName)}}
                    </div>
                    <div class="col-4">
                        Pays  {{ form_widget(cityForm.country)}}
                    </div>
                    <div class="col">
                        <button type="submit" class="btn btn-link"><br>Ajouter adresse</button>
                    </div>
                </div>
            </form>

            {#Affiche personnes de contact#}
            <h3> <br>Personnes de contact</h3>

            {% for contactList in user.contactLists %}
               {# <form action="{{path('remove_PoC',{'idCL':contactList.id, 'idUser':user.id}) }}" method="post">#}
                    <div class="personOfContact">
                        <div class="row">
                            <div class="col-2">
                               Nom: {{ contactList.personOfContact.name }}
                            </div>
                            <div class="col">
                                Prénom : {{ contactList.personOfContact.firstName }}
                            </div>
                            <div class="col">
                                Numéro : {{ contactList.personOfContact.num1 }}
                            </div>
                            <div class="col">
                                Relation : {{ contactList.relation }}
                            </div>
                            <div class="col">
                                Info : {{ contactList.info }}
                            </div>
                        </div>
                        <div>
                            <div class="row">
                            <div class="col">
                                {#<button type="submit" class="btn btn-link">Supprimer personne de contact</button>#}
                                <a href="{{ path('remove_PoC',{'idCL':contactList.id, 'idUser':app.user.id}) }}">Supprimer personne de contact</a>
                           </div>
                            </div>
                        </div>
                    </div>
               {# </form> #}
                <div class="col">
                    <a href="{{ path('edit_PoC',{'id':app.user.id, 'idCL':contactList.id, 'idPoC':contactList.personOfContact.id}) }}">Modifier personne de contact</a>
                </div>
            {% endfor %}

            <h4> <br>Nouvelle personne de contact</h4>
            <form action="{{path('profile_edit',{'id':user.id}) }}" method="post">
                <div class="row">
                    <div class="col-3">
                        Nom {{ form_widget(PoCForm.name) }}
                    </div>
                    <div class="col-3">
                        Prénom {{ form_widget(PoCForm.firstName) }}
                    </div>
                    <div class="col-3">
                        Numéro 1 {{ form_widget(PoCForm.num1) }}
                    </div>
                    <div class="col-2">
                        Info {{ (form_widget(ContactListForm.relation) ) }}
                    </div>
                    <div class="col-5">
                        Info {{ (form_widget(ContactListForm.info) ) }}
                    </div>
                    <div class="col">
                        <button type="submit" class="btn btn-link"><br>Ajouter une nouvelle personne de contact</button>
                    </div>
                </div>
            </form>

        {% else %}
            <h2> Vous n'êtes pas autorisé à accéder à cette page </h2>
            <a href="{{ path('security_logout') }}" class="btn-btn-primary">
                Déconnexion ?
            </a>
        {% endif %}
    {% else %}
        <h2>Vous n'êtes pas connecté !</h2>
        <a href="{{ path('security_login') }}" class="btn-btn-primary">
            Connexion
        </a>
    {% endif %}


{% endblock %}